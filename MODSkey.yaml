attrqname: 
  uri: http://www.w3.org/2001/XMLSchema-instance
  tag: schemaLocation
nsmap: {mods: http://www.loc.gov/mods/v3, xsi: http://www.w3.org/2001/XMLSchema-instance, xlink: http://www.w3.org/1999/xlink}
elementnamespace: '{http://www.loc.gov/mods/v3}'
parenttag: 'mods'

authorities: 
  - {suffix: LC, authority: lcsh, authorityURI: http://id.loc.gov/authorities/subjects.html}
  - {suffix: FAST, authority: fast, authorityURI: http://id.worldcat.org/fast}
  - {suffix: Local, authority: local}
  - {suffix: RBGENR, authority: rbgenr, authorityURI: https://rbms.info/vocabularies/genre/alphabetical_list.htm}

skipif:
 - recordgroupTitle
 - subgroupTitle
 - seriesTitle
 - subSeriesTitle
 - Ignore

fields:
  - type: element 
    name: titleInfo
    children:
      - type: element 
        name: title
        text:
          - type: value
            values:
              - {type: col, header: fileTitle, method: value}
          - {header: itemTitle, method: value}
      - type: element 
        name: subTitle
        text:
          - type: value
            values:
              - {type: col, header: subTitle, method: value}
      - type: element 
        name: partNumber
        text:
          - type: value
            values:
              - {type: col, header: itemTitlePartNumber, method: num}
      - type: element 
        name: partName
        text:
          - type: value
            values:
              - {type: col, header: itemTitlePartName, method: value}

  - type: element 
    name: titleInfo
    attrs: {type: translated}
    children:
      - type: element
        name: title
        text:
          - type: value
            values:
              - {type: col, header: itemTitleTranslated, method: value}

  - type: element 
    name: titleInfo
    attrs: {type: alternative}
    children:
      - type: element
        name: title
        text:
          - type: value
            values:
              - {type: col, header: itemTitleAlternate, method: value}

  - type: element
    name: titleInfo
    attrs: {type: alternative, displayLabel: Pembroke title}
    children:
      - type: element
        name: title
        text:
          - type: value
            values:
              - {type: col, header: itemTitleAlternatePembroke, method: value}

  - type: repeating
    method: nameauthority
    colprefix:
      - namePersonCreator
    defaults: {entry.role: creator}
    element:
      name: name
      attrs: {type: personal}
      conditionalattrs: 
        - key: authority
          col: entry.authority
          method: value
        - key: valueURI
          col: entry.valueURI
          method: value
        - key: authorityURI
          col: entry.authorityURI
          method: value
      children:
        - type: element
          name: namePart
          attrs: {type: termsOfAddress}
          text:
          - type: value
            values:
              - {type: col, header: entry.prependTermOfAddress, method: value}
        - type: element
          name: namePart
          text:
          - type: value
            values:
              - {type: col, header: entry.name, method: value}
        - type: element
          name: namePart
          attrs: {type: termsOfAddress}
          text:
          - type: value
            values:
              - {type: col, header: entry.appendTermOfAddress, method: value}
        - type: element
          name: namePart
          attrs: {type: date}
          text:
          - type: value
            values:
              - {type: col, header: entry.date, method: value}
        - type: element
          name: role
          children:
          - type: element
            name: roleTerm
            attrs: {type: text, authority: marcrelator}
            text:
            - type: value
              values:
                - {type: col, header: entry.role, method: value}

  - type: repeating
    method: name
    colprefix:
      - namePersonOther
    element:
      name: name
      attrs: {type: personal}
      conditionalattrs: 
        - key: authority
          col: entry.authority
          method: value
        - key: valueURI
          col: entry.valueURI
          method: value
        - key: authorityURI
          col: entry.authorityURI
          method: value
      children:
        - type: element
          name: namePart
          attrs: {type: termsOfAddress}
          text:
          - type: value
            values:
              - {type: col, header: entry.prependTermOfAddress, method: value}
        - type: element
          name: namePart
          text:
          - type: value
            values:
              - {type: col, header: entry.name, method: value}
        - type: element
          name: namePart
          attrs: {type: termsOfAddress}
          text:
          - type: value
            values:
              - {type: col, header: entry.appendTermOfAddress, method: value}
        - type: element
          name: namePart
          attrs: {type: date}
          text:
          - type: value
            values:
              - {type: col, header: entry.date, method: value}
        - type: element
          name: role
          children:
          - type: element
            name: roleTerm
            attrs: {type: text, authority: marcrelator}
            text:
            - type: value
              values:
                - {type: col, header: entry.role, method: value}

  - type: repeating
    method: name
    colprefix:
      - nameCorpCreator
    defaults: {entry.role: creator}
    element:
      name: name
      attrs: {type: corporate}
      conditionalattrs: 
        - key: authority
          col: entry.authority
          method: value
        - key: valueURI
          col: entry.valueURI
          method: value
        - key: authorityURI
          col: entry.authorityURI
          method: value
      children:
        - type: element
          name: namePart
          attrs: {type: termsOfAddress}
          text:
          - type: value
            values:
              - {type: col, header: entry.prependTermOfAddress, method: value}
        - type: element
          name: namePart
          text:
          - type: value
            values:
              - {type: col, header: entry.name, method: value}
        - type: element
          name: namePart
          attrs: {type: termsOfAddress}
          text:
          - type: value
            values:
              - {type: col, header: entry.appendTermOfAddress, method: value}
        - type: element
          name: namePart
          attrs: {type: date}
          text:
          - type: value
            values:
              - {type: col, header: entry.date, method: value}
        - type: element
          name: role
          children:
          - type: element
            name: roleTerm
            attrs: {type: text, authority: marcrelator}
            text:
            - type: value
              values:
                - {type: col, header: entry.role, method: value}

  - type: element 
    name: typeOfResource 
    text:
      - type: value
        values:
          - {type: col, header: typeOfResource, method: value}
    conditionalattrs:
      - key: manuscript
        col: typeOfResourceManuscript
        method: ifpresent
        value: 'yes'
      - key: collection 
        col: typeOfResourceCollection
        method: ifpresent
        value: 'yes'
  
  - type: repeating
    method: value
    colprefix:
      - genre
    element:
      name: genre
      conditionalattrs: 
        - key: authority
          col: entry.authority
          method: value
        - key: valueURI
          col: entry.valueURI
          method: value
        - key: authorityURI
          col: entry.authorityURI
          method: value
      text:
        - type: value
          values:
            - {type: col, header: entry.value, method: value}

  - type: element
    name: abstract
    attrs: {type: general, displayLabel: Scope and Contents note}
    text:
      - type: value
        values:
          - {type: col, header: noteScope, method: value}

  - type: element
    name: note
    attrs: {type: acquisition, displayLabel: Immediate form of acquisition}
    text:
      - type: value
        values:
          - {type: col, header: noteAccession, method: value}

  - type: element
    name: note
    attrs: {type: biographical/historical, displayLabel: Biographical/historical note}
    text:
      - type: value
        values:
          - {type: col, header: noteHistorical, method: value}

  - type: element
    name: note
    attrs: {type: general}
    text:
      - type: value
        values:
          - {type: col, header: noteGeneral, method: value}

  - type: element
    name: note
    attrs: {type: biographical/historical, displayLabel: Class year}
    text:
      - type: value
        values:
          - {type: col, header: noteHistoricalClassYear, method: value}

  - type: element
    name: note
    attrs: {type: venue}
    text:
      - type: value
        values:
          - {type: col, header: noteVenue, method: value}

  - type: element
    name: note
    attrs: {type: preferredcitation}
    text:
      - type: ifpresent
        col: fileTitle
        values: 
          - {type: col, header: fileTitle}
      - type: ifpresent
        col: itemTitle
        values: 
          - {type: col, header: itemTitle}
      - type: ifpresent
        col: collection
        values: 
          - {type: value, text: ", "}
          - {type: col, header: collection}
      - type: ifpresent
        col: callNumber
        values: 
          - {type: value, text: ", "}
          - {type: col, header: callNumber}
      - type: value
        values: 
          - {type: value, text: ", Brown University Library"}

  - type: element
    name: originInfo
    children:
      - type: element
        name: publisher
        text:
        - type: value
          values:
            - {type: col, header: publisher, method: value}
      - type: element
        name: dateCreated
        conditionalattrs:
          - key: qualifier
            col: dateQualifier
            method: value
          - key: keyDate
            value: "yes"
            col: dateStart
            method: ifnotpresent
        text:
          - type: value
            values:
              - {type: col, header: dateText, method: num}
      - type: element
        name: dateCreated
        attrs: {encoding: w3cdtf, keyDate: "yes", point: start}
        conditionalattrs:
          - key: qualifier
            col: dateQualifier
            method: value
        text:
          - type: value
            values:
              - {type: col, header: dateStart, method: num}         
      - type: element
        name: dateCreated
        attrs: {encoding: w3cdtf, point: end}
        conditionalattrs:
          - key: qualifier
            col: dateQualifier
            method: value
        text:
          - type: value
            values:
              - {type: col, header: dateEnd, method: num}  
      - type: element
        name: place
        children:
          - type: element
            name: placeTerm
            attrs: {type: text}
            text:
            - type: value
              values:
                - {type: col, header: place, method: value}

#### Language

  - type: element
    name: physicalDescription
    children:
      - type: element
        name: extent
        text:
          - type: value
            values:
              - {type: col, header: extentQuantity, method: value}     
      - type: element
        name: extent
        text:
          - type: value
            values:
              - {type: col, header: extentSize, method: value}   
      - type: element
        name: extent
        text:
          - type: value
            values:
              - {type: col, header: extentSpeed, method: value} 
      - type: element
        name: digitalOrigin
        text:
          - type: value
            values:
              - {type: col, header: digitalOrigin, method: value}
      - type: element
        name: form
        text:
          - type: value
            values:
              - {type: col, header: form, method: value}

  - type: element
    name: accessCondition
    attrs: {type: use and reproduction}
    text:
      - type: value
        values:
          - {type: col, header: useAndReproduction, method: value}

  - type: element
    name: accessCondition
    attrs: {type: rights statement}
    conditionalattrs:
      - key: "{http://www.w3.org/1999/xlink}href"
        col: rightsStatementURI
        method: value
    text:
      - type: value
        values:
          - {type: col, header: rightsStatementText, method: value}

  - type: element
    name: accessCondition
    attrs: {type: restriction on access}
    text:
      - type: value
        values: 
          - {type: value, text: "Collection is open for research."}

  - type: repeating
    method: name
    colprefix:
      - subjectNames
    element:
      name: subject
      children:
        - type: element
          name: name
          attrs: {type: personal}
          conditionalattrs: 
            - key: authority
              col: entry.authority
              method: value
            - key: valueURI
              col: entry.valueURI
              method: value
            - key: authorityURI
              col: entry.authorityURI
              method: value
          children:
            - type: element
              name: namePart
              attrs: {type: termsOfAddress}
              text:
              - type: value
                values:
                  - {type: col, header: entry.prependTermOfAddress, method: value}
            - type: element
              name: namePart
              text:
              - type: value
                values:
                  - {type: col, header: entry.name, method: value}
            - type: element
              name: namePart
              attrs: {type: termsOfAddress}
              text:
              - type: value
                values:
                  - {type: col, header: entry.appendTermOfAddress, method: value}
            - type: element
              name: namePart
              attrs: {type: date}
              text:
              - type: value
                values:
                  - {type: col, header: entry.date, method: value}
            - type: element
              name: role
              children:
              - type: element
                name: roleTerm
                attrs: {type: text, authority: marcrelator}
                text:
                - type: value
                  values:
                    - {type: col, header: entry.role, method: value}

  - type: repeating
    method: name
    colprefix:
      - subjectCorp
    element:
      name: subject
      children:
        - type: element
          name: name
          attrs: {type: corporate}
          conditionalattrs: 
            - key: authority
              col: entry.authority
              method: value
            - key: valueURI
              col: entry.valueURI
              method: value
            - key: authorityURI
              col: entry.authorityURI
              method: value
          children:
            - type: element
              name: namePart
              attrs: {type: termsOfAddress}
              text:
              - type: value
                values:
                  - {type: col, header: entry.prependTermOfAddress, method: value}
            - type: element
              name: namePart
              text:
              - type: value
                values:
                  - {type: col, header: entry.name, method: value}
            - type: element
              name: namePart
              attrs: {type: termsOfAddress}
              text:
              - type: value
                values:
                  - {type: col, header: entry.appendTermOfAddress, method: value}
            - type: element
              name: namePart
              attrs: {type: date}
              text:
              - type: value
                values:
                  - {type: col, header: entry.date, method: value}
            - type: element
              name: role
              children:
              - type: element
                name: roleTerm
                attrs: {type: text, authority: marcrelator}
                text:
                - type: value
                  values:
                    - {type: col, header: entry.role, method: value}

  - type: repeating
    method: value
    colprefix:
      - subjectTopics
    element:
      name: subject
      conditionalattrs: 
        - key: authority
          col: entry.authority
          method: value
        - key: valueURI
          col: entry.valueURI
          method: value
        - key: authorityURI
          col: entry.authorityURI
          method: value
      children:
        - type: element
          name: topic
          text:
            - type: value
              values:
                - {type: col, header: entry.value, method: value}

  - type: repeating
    method: value
    colprefix:
      - subjectTopicsGeo
    element:
      name: subject
      conditionalattrs: 
        - key: authority
          col: entry.authority
          method: value
        - key: valueURI
          col: entry.valueURI
          method: value
        - key: authorityURI
          col: entry.authorityURI
          method: value
      children:
        - type: element
          name: geographic
          text:
            - type: value
              values:
                - {type: col, header: entry.value, method: value}

  - type: repeating
    method: value
    colprefix:
      - subjectTopicsTemporal
    element:
      name: subject
      conditionalattrs: 
        - key: authority
          col: entry.authority
          method: value
        - key: valueURI
          col: entry.valueURI
          method: value
        - key: authorityURI
          col: entry.authorityURI
          method: value
      children:
        - type: element
          name: temporal
          text:
            - type: value
              values:
                - {type: col, header: entry.value, method: value}

  - type: repeating
    method: value
    cols:
      - subjectTopicsFreedomNow
    defaults: {entry.authority: local}
    element:
      name: subject
      attrs:  {displayLabel: Freedom Now! keyword}
      conditionalattrs: 
        - key: authority
          col: entry.authority
          method: value
      children:
        - type: element
          name: topic
          text:
            - type: value
              values:
                - {type: col, header: entry.value, method: value}

  - type: repeating
    method: value
    colprefix:
      - subjectTitle
    element:
      name: subject
      conditionalattrs: 
        - key: authority
          col: entry.authority
          method: value
        - key: valueURI
          col: entry.valueURI
          method: value
        - key: authorityURI
          col: entry.authorityURI
          method: value
      children:
        - type: element
          name: titleInfo
          children:
            - type: element
              name: title
              text:
                - type: value
                  values:
                    - {type: col, header: entry.value, method: value}

  - type: element
    name: subject
    children:
      - type: element
        name: cartographics
        children:
          - type: element
            name: cartographicExtension
            children: 
              - type: element
                name: coordinates
                text:
                  - type: value
                    values:
                      - {type: col, header: coordinates, method: value}
              - type: element
                name: scale
                text:
                  - type: value
                    values:
                      - {type: col, header: scale, method: value}
              - type: element
                name: projection
                text:
                  - type: value
                    values:
                      - {type: col, header: projection, method: value}

  - type: element
    name: relatedItem
    attrs: {type: host}
    children:
      - type: element
        name: titleInfo
        children:
          - type: element
            name: title
            text:
              - type: value
                values:
                  - {type: col, header: collection, method: value}
          - type: element
            name: originInfo
            children: 
              - type: element
                name: dateCreated
                text:
                  - type: value
                    values:
                      - {type: col, header: dateTextParent, method: num}
          - type: element
            name: identifier
            attrs: {type: local}
            text:
              - type: value
                values:
                  - {type: col, header: callNumber, method: value}
          - type: element
            name: location
            children:
              - type: element
                name: physicalLocation
                text:
                  - type: value
                    values:
                      - {type: col, header: repository, method: value}
              - type: element
                name: url
                text:
                  - type: value
                    values:
                      - {type: col, header: findingAid, method: value}

#### Shelf locator and location elements

  - type: element
    name: identifier
    conditions:
      - {type: startswith, col: identifierBDR, text: bdr}
    attrs: {type: local, displayLabel: BDR_PID}
    text:
      - type: value
        values: 
          - {type: value, text: "bdr:"}
      - type: removetext
        removetext: 
          - "bdr:"
          - bdr 
        values:
          - {type: col, header: identifierBDR}

  - type: element
    name: identifier
    conditions:
      - {type: startswith, col: identifierBDR, text: bdr}
    attrs: {type: local, displayLabel: MODS_ID}
    text:
      - type: value
        values: 
          - {type: value, text: "bdr"}
      - type: removetext
        removetext: 
          - "bdr:"
          - bdr 
        values:
          - {type: col, header: identifierBDR}

  - type: element
    name: note
    attrs: {displayLabel: Digital object made available by}
    text:
      - type: value
        values: 
          - {type: value, text: "Brown University Library, John Hay Library, University Archives and Manuscripts, Box A, Brown University, Providence, RI, 02912, U.S.A., (http://library.brown.edu/)"}